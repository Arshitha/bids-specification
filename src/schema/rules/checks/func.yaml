# Rules for functional data that are not defined in tables.
---
PhaseSuffixDeprecated:
  issue:
    code: PHASE_SUFFIX_DEPRECATED
    message: |
      DEPRECATED. Phase information associated with magnitude information stored in BOLD contrast.
      This suffix should be replaced by the part-phase in conjunction with the bold suffix.
      For backwards compatibility, _phase is considered equivalent to _part-phase_bold.
      When the _phase suffix is not used, each file shares the same name with the exception of the
      part-<mag|phase> or part-<real|imag> key/value.
    level: warning
  selectors:
    - datatype == "func"
  checks:
    - suffix != "phase"

### The following rules implement the functional imaging acquisition timing rules
### For the sake of informative errors, they are implemented in more rules than
### strictly necessary
### The selectors/checks are implemented with the least likely case in the selector
### for efficiency.

# 178
VolumeTimingRepetitionTimeMutex:
  issue:
    code: VOLUME_TIMING_AND_REPETITION_TIME_MUTUALLY_EXCLUSIVE
    message: |
      The fields 'VolumeTiming' and 'RepetitionTime' for this file are mutually exclusive.
      Choose 'RepetitionTime' when the same repetition time is used for all volumes,
      or 'VolumeTiming' when variable times are used.
    level: error
  selectors:
    - type(sidecar.VolumeTiming) != null
  checks:
    - type(sidecar.RepetitionTime) == null

RepetitionTimeAcquisitionDurationMutex:
  issue:
    code: REPETITION_TIME_AND_ACQUISITION_DURATION_MUTUALLY_EXCLUSIVE
    message: |
      The fields 'RepetitionTime' and 'AcquisitionDuration' for this file are mutually exclusive.
      To specify acquisition duration, use 'SliceTiming' or 'DelayTime'
      (RepetitionTime - AcquisitionDuration).
    level: error
  selectors:
    - type(sidecar.AcquistionDuration) != null
  checks:
    - type(sidecar.RepetitionTime) == null

VolumeTimingDelayTimeMutex:
  issue:
    code: VOLUME_TIMING_AND_DELAY_TIME_MUTUALLY_EXCLUSIVE
    message: |
      The fields 'VolumeTiming' and 'DelayTime' for this file are mutually exclusive.
      To specify acquisition duration, use 'AcquisitionDuration' or 'SliceTiming'.
    level: error
  selectors:
    - type(sidecar.VolumeTiming) != null
  checks:
    - type(sidecar.DelayTime) == null

SliceTimingAcquisitionDurationMutex:
  issue:
    code: SLICE_TIMING_AND_DURATION_MUTUALLY_EXCLUSIVE
    message: |
      'SliceTiming' is defined for this file.
      Neither 'DelayTime' nor 'AcquisitionDuration' may be defined in addition.
    level: error
  selectors:
    - type(sidecar.SliceTiming) != null
  checks:
    - type(sidecar.AcquisitionDuration) == null
    - type(sidecar.DelayTime) == null
