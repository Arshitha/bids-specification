---
SubjectRelativeIntendedForString:
  selectors:
    - datatype != "ieeg"
    - type(sidecar.IntendedFor) == "string"
  checks:
    - exists(sidecar.IntendedFor, "bids-uri") + exists(sidecar.IntendedFor, "subject") == 1

SubjectRelativeIntendedForArray:
  selectors:
    - datatype != "ieeg"
    - type(sidecar.IntendedFor) == "array"
  checks:
    - exists(sidecar.IntendedFor, "bids-uri") + exists(sidecar.IntendedFor, "subject") == length(sidecar.IntendedFor)

DatasetRelativeIntendedForString:
  selectors:
    - datatype == "ieeg"
    - type(sidecar.IntendedFor) == "string"
  checks:
    - exists(sidecar.IntendedFor, "bids-uri") + exists(sidecar.IntendedFor, "dataset") == 1

DatasetRelativeIntendedForArray:
  selectors:
    - datatype == "ieeg"
    - type(sidecar.IntendedFor) == "array"
  checks:
    - exists(sidecar.IntendedFor, "bids-uri") + exists(sidecar.IntendedFor, "dataset") == length(sidecar.IntendedFor)

AssociatedEmptyRoomString:
  selectors:
    - datatype == "meg"
    - type(sidecar.AssociatedEmptyRoom) == "string"
  checks:
    - exists(sidecar.AssociatedEmptyRoom, "bids-uri") + exists(sidecar.AssociatedEmptyRoom, "dataset") == 1

AssociatedEmptyRoomArray:
  selectors:
    - datatype == "meg"
    - type(sidecar.AssociatedEmptyRoom) == "array"
  checks:
    - |
      exists(sidecar.AssociatedEmptyRoom, "bids-uri") + exists(sidecar.AssociatedEmptyRoom, "dataset")
      == length(sidecar.AssociatedEmptyRoom)

Sources:
  selectors:
    - dataset.dataset_description.DatasetType == "derivatives"
    - type(sidecar.Sources) != "null"
  checks:
    - exists(sidecar.Sources, "bids-uri") + exists(sidecar.Sources, "dataset") == length(sidecar.Sources)

SpatialReferencesString:
  selectors:
    - dataset.dataset_description.DatasetType == "derivatives"
    - type(sidecar.SpatialReference.URI) == "string"
  checks:
    - exists(sidecar.SpatialReference.URI, "bids-uri") + exists(sidecar.SpatialReference.URI, "dataset") == 1

SpatialReferencesArray:
  selectors:
    - dataset.dataset_description.DatasetType == "derivatives"
    - type(sidecar.SpatialReference.URI) == "array"
  checks:
    - exists(sidecar.SpatialReference.URI, "bids-uri") + exists(sidecar.SpatialReference.URI, "dataset") == length(sidecar.SpatialReference.URI)
